
<font align = center>

**[joint marginal, box, discrete scatter plots](#special)** | **[pretty bar plots](#pretty)** <br> **[plotting utilities](#utils)** | **[interactive plots](#inter)** <br> **[other gg plots](#other)** | **[survival plots in base and gg](#surv)**

</font>

more stuff <a href = 'https://github.com/raredd/rgraphics'>here</a>

---

```{r knitr/r stuff, include=FALSE}
library(knitr)
options(figure_counter = TRUE)
opts_chunk$set(dev = 'png',
               # dev.args = list(type = 'cairo'),
               dpi = 96)
opts_knit$set(eval.after = 'fig.cap')
knit_hooks$set(plot = function(x, options) {
  fig_fn = paste0(opts_knit$get('base.url'),
                  paste(x, collapse = '.'))
  fig.cap <- knitr:::.img.cap(options)
  style = c('display:block',
            sprintf('margin: %s;',
                    switch(options$fig.align,
                           left = 'auto auto auto 0',
                           center = 'auto',
                           right = 'auto 0 auto auto')))
  addon_args = ''
  fig_number_txt <- ''
  cntr <- getOption('figure_counter', FALSE)
  if (cntr != FALSE) {
    if (is.logical(cntr))
      cntr <- 1
    fig_number_txt <- 
      sprintf(getOption('figure_counter_str', 'Figure %s: '),
              ifelse(getOption('figure_counter_roman', FALSE),
                     as.character(as.roman(cntr)), as.character(cntr)))
    if (is.numeric(cntr))
      options(figure_counter = cntr + 1)
  }
  paste0("<figure><img src='", fig_fn, "'"," ", addon_args,
         paste0(" style='", paste(style, collapse = '; '), "'"),'>',
         '<figcaption>', fig_number_txt, fig.cap, '</figcaption></figure>')
})
```

### some rawr graphics

```{r}
library(rawr)
library(ggplot2)
library(grid)
library(gridExtra)

op <- par(no.readonly = TRUE)
```

### <a id = 'special'>joint marginal, box, and discrete scatter plots</a>

```{r spplots, tidy=FALSE, fig.height=8, fig.width=8, fig.align='center', fig.cap='special plots'}
## jmplot
set.seed(1618)
dat <- data.frame(x = rnorm(100, 20, 5),
                  y = rexp(100),
                  z = c('M','F'),
                  zz = c(LETTERS[1:4]))
dat[1:5, 1:2] <- NA
with(dat, jmplot(x, y, z, type = 'db', jit = .02, col = 1:2, las = 1,
     group.col = TRUE, pch = 1:2, group.pch = TRUE, boxcol = grey(.9),
     cex.n = .8))
## tplot
par(op)
set.seed(1618)
dat <- data.frame(age = rnorm(80, rep(c(26, 36), c(70, 10)), 4),
                  sex = sample(c('Female', 'Male'), 80, replace = TRUE),
                  group = paste0('Group ',
                                 sample(1:4, 40, prob = c(2, 5, 4, 1),
                                        replace = TRUE)))
dat[1:5, 'age'] <- NA
tplot(age ~ group, data = dat, las = 1, cex.n = .8, cex.axis = 1, bty = 'L',
      type = c('db', 'db', 'db', 'd'), names = LETTERS[1:4],
      group.pch = TRUE, pch = c(15, 17, 19, 8),
      group.col = FALSE, col = c('darkred', 'darkblue')[c(sex)],
      boxcol = c('lightsteelblue1', 'lightyellow1', grey(.9)),
      boxplot.pars = list(notch = TRUE, boxwex = .5))
## dsplot
par(op)
set.seed(1618)
x <- round(rnorm(400, 100, 4))
y <- round(rnorm(400, 200, 4))
sex <- sample(c('Female', 'Male'), 400, replace = TRUE)
dsplot(y ~ x, pch = 19, col = 1 + (sex %in% 'Female'), cex = .6,
       xlab = 'measurement 1', ylab = 'measurement 2', bty = 'L')
legend('bottomright', pch = 19, col = 1:2, bty = 'n',
       legend = c('Male', 'Female'), cex = .8)
```

### ### <a id = 'pretty'>pretty bars</a>

```{r prettybars, tidy=FALSE, fig.width=11, fig.cap='prettybars'}
## kinda pretty?
prettybars(mtcars$mpg, y = rownames(mtcars), col.bg = 'snow',
           emph = rownames(mtcars)[grepl('Merc', rownames(mtcars))],
           extra.margin = 1, col.emph = 'cyan2',
           FUN = quantile, probs = c(.25, .5, .75), na.rm = TRUE, 
           fun.lab = c('lower quartile','median','upper quartile'),
           note = "if you buy a Merccedes,\nget ready to pay for lots of gas",
           title = 'motor trend cars', sub = '   (miles per gallon)')
## a face only a mother could love
set.seed(1618)
f <- function(...) sample(1:5, 100, replace = TRUE, prob = c(...))
dat <- data.frame(q1 = f(.1, .2, .3, .3, .1),
                  q2 = f(.1, .4, .1, .3, .1),
                  q3 = f(.1, .2, .3, .3, .1),
                  q4 = f(.1, .1, .3, .3, .1),
                  q5 = f(.2, .1, .2, .3, .2),
                  q6 = f(.1, .3, .3, .2, .1),
                  q7 = f(.1, .4, .1, .1, .3))
dat <- stack(dat)
dat <- within(dat, {
  values <- factor(values, levels = 1:5, labels = c('NA','SA','A','D','SD'))})

mydata <- table(dat)
cols <- c(grey(.9), tcol(c('lightblue','lightblue','magenta1','magenta1'), 
               c(200, 100, 100, 200)))

prettybars2(mydata, lab.y = paste('Question #', 1:7), extra.margin = 3, 
            col.group = cols)
```

```{r legend, tidy=FALSE, fig.height=8, fig.cap='Legend'}
## a pretty legend
par(mfrow = c(2,1))
with(mtcars,
     plot(mpg, pch = 19, cex = 2, main = 'color by weight (red = heavier)',
     col = colorRampPalette(c('yellow','red'))(1000)[rescaler(wt, c(1, 1000))]))
with(mtcars,
     plot(mpg, pch = 19, cex = 2, bty = 'l', main = 'color by weight (red = heavier)',
     col = color.bar(c('yellow','red'), x = wt, y = mpg, labels = wt)))
```

### <a id = 'utils'>plotting utilities</a>

```{r rawr plot utils, tidy=FALSE, fig.height=8, fig.width=10, fig.align='center', fig.cap='Utilities'}
## show colors
colors()[70]
show.colors()
## show plotting characters
show.pch()
## transparent colors
cols <- c('orange', 'magenta1', 'lightblue')
plot(rnorm(100), col = tcol(cols, 100), pch = 16, cex = 4, 
     axes = FALSE, xpd = NA, xlab = '', ylab = '')
## add missing facets for some ggplots

## ?facet_adjust
library(ggplot2)
library(grid)
# missing some labels
(tmp <- ggplot(diamonds[1:100, ], aes(carat, price, colour = clarity)) +
  geom_point() + facet_wrap( ~ cut))
facet_adjust(tmp)
## ?dodge
par(op)
set.seed(1618)
dat <- data.frame(x = rpois(50, 1), grp = 1:5)
par(list(mfrow = c(2, 2),
         mar = c(3,1,2,2)))
with(dat, plot(grp, x, main = 'overlapping points'))
with(dat, plot(grp, x, cex = runif(100), main = 'still overlapping points'))
with(dat, plot(jitter(grp), x, main = 'adding random noise'))
with(dat, plot(grp + dodge(x ~ grp, dat), x, main = 'dodge points'))
```

### <a id = 'inter'>interactive base plots</a>

```{r rawr interactive, eval=FALSE, tidy=FALSE}
## add shapes or text (and expressions) interactively

?click.shape

?click.text
```

### <a id = 'other'>other gg plots</a>

```{r spggplot, message=FALSE, tidy=FALSE, fig.height=8, fig.width=12, fig.align='center', fig.cap='Other ggplots'}
## heat map

## ?ggheat
tmp <- rescaler(matrix(1:25, 5))
diag(tmp) <- 1
colnames(tmp) <- rownames(tmp) <- LETTERS[1:5]
grobs <- list(ggheat(cors = tmp, limits = c(0, 1)),
              ggheat(cors = tmp, gradn = NULL, gradc = c('white','red')))
(do.call(arrangeGrob, c(grobs, nrow = 1, ncol = 2)))
## caterpillar plot

## ?ggcaterpillar
library(lme4)
fit <- lmer(Reaction ~ Days + (Days | Subject), data = sleepstudy)
ggcaterpillar(ranef(fit, condVar = TRUE))
```

### <a id = 'surv'>survival plots in base and gg</a>

```{r rawr survival, tidy=FALSE, fig.height=8, fig.width=12, fig.align='center', fig.cap='Survival curves'}
## create kaplan-meier or cox ph plots with base or gg
try_require(survival)
cancer <- within(cancer, {
  age.cat <- factor(as.numeric(cut(age, c(-Inf, 50, 60, 70, Inf))))
})
kmfit <- survfit(Surv(time = time, event = status) ~ sex, data = cancer,
  conf.type = 'log-log')
coxfit <- survfit(coxph(Surv(time = time, event = status) ~ strata(I(age > 45)),
  data = cancer))
## base plots
## ?kmplot
kmplot(kmfit, dev = FALSE, col.band = 1:2, strata.lab = c('Male','Female'))
## ggplot plots
## ?ggsurv
ggsurv(coxfit, legend.labels = c('< 45','> 45'), legend = FALSE, median = TRUE)
```

---

<font align = center>

<a href="mailto:raredd01@gmail.com?subject=rawr">email</a>

Most recent compile: `r as.character(format(Sys.Date(), format = '%d %B %Y'))` (`r as.character(R.Version()$version.string)`)

</font>